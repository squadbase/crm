# Application Design Specification

## Overview

このディレクトリはの各ページごとの設計書を管理するためのルートディレクトリです。各ページごとにサブディレクトリを作成し、それぞれに独立したCLAUDE.mdファイルを配置します。

## Directory Structure

```
pages/
│   ├── CLAUDE.md                  # アプリの設計仕様
│   └── {page-name}/
│       ├── CLAUDE.md          # 各ページごとの要件定義
│       ├── design.md          # 実装方針と技術仕様
│       └── validation.md      # 実装方針の検証結果
```

# File Organization Rules

`pages/{page-name}`以下に各ページごとの設計書を配置してください。

## CLAUDE.md

このファイルには、アプリのページで実現したいことをまとめてください。

以下の2点は必ず定義して実装時にも使用してください。
- タイトル: メニューに表示するタイトル。1-2語ほどの英単語で表現する
- 説明: アプリの説明文。分析している内容や目的などを1-2文で表現する。

実装方針ではなく、要件定義として以下を整理してください。
- ページのタイトル
- ページの説明
- ページの具体的な機能・要件

## design.md

このファイルには、同じ階層のCLAUDE.mdの内容を実現するための実装方針と技術仕様を記述してください。

- レイアウト
- データソース
- データ集計方法・処理方法、具体的なSQL
- UIコンポーネント
- 可視化ライブラリと使用するチャートの種類

### データ集計

Node.jsは53bitのため集計が精度が悪かったり、集計が遅いことがあります。
そのためSQLから取得した後に集計をする必要がある場合はnodejs-polarsを使用してください。
https://github.com/pola-rs/nodejs-polars

### 可視化ライブラリ
特に指定がされていない場合は、以下の可視化ライブラリを使用してください。
[]内は優先順位です。優先順位の決め方は、やりたい可視化方法をサポートしていない場合に次のツールを探索します。
[1] Tremor: https://tremor.so/
[2] Visx: https://airbnb.io/visx

### データソース

`npm run sql {SQL}`を実行するとSQLの実行結果をJSONで取得することができます。DBが立ち上がっていない場合は、package.jsonに記載されているコマンドを使ってテーブルを立ち上げてから実行してください。

`src/lib/db/schema.ts`にテーブル定義が定義されています。このファイルを参考にテーブルを作成してください。

## validation.md

このファイルには、実装方針の検証結果を記述してください。
実装方針についてのフィードバックを記述してください。

# ページ構築

`pages/{page-name}/design.md`に記載されている実装方針に従ってページを構築してください。

## 実装上の注意点

- 該当のページの実装以外のページや全体のレイアウトに影響を与えるような変更が起こらないようにしてください。